function checkTime(a,b){if(!a)return!1;var c=new Date(a),d=new Date(b);b=c.getMonth()+1;a=c.getFullYear();c=c.getDate();var e=d.getMonth()+1,f=d.getFullYear();d=d.getDate();return a>f?!1:b>e?!1:c>d?!1:!0}function DateDiff(a,b){a=a.split("-");var c=new Date(a[1]+"-"+a[2]+"-"+a[0]);a=b.split("-");return parseInt(Math.abs(c-new Date(a[1]+"-"+a[2]+"-"+a[0]))/1E3/60/60/24)+1}
function DateAfter(a,b){a=new Date(a);b=a.getTime()+864E5*parseInt(b-1);a.setTime(b);b=parseInt(a.getMonth())+1+"";var c=a.getDate()+"";1==b.length&&(b="0"+b);1==c.length&&(c="0"+c);return a.getFullYear()+"-"+b+"-"+c}
$(function(){$.fn.datetimepicker.dates["zh-CN"]={days:"\u661f\u671f\u65e5 \u661f\u671f\u4e00 \u661f\u671f\u4e8c \u661f\u671f\u4e09 \u661f\u671f\u56db \u661f\u671f\u4e94 \u661f\u671f\u516d \u661f\u671f\u65e5".split(" "),daysShort:"\u5468\u65e5 \u5468\u4e00 \u5468\u4e8c \u5468\u4e09 \u5468\u56db \u5468\u4e94 \u5468\u516d \u5468\u65e5".split(" "),daysMin:"\u65e5\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u65e5".split(""),months:"\u4e00\u6708 \u4e8c\u6708 \u4e09\u6708 \u56db\u6708 \u4e94\u6708 \u516d\u6708 \u4e03\u6708 \u516b\u6708 \u4e5d\u6708 \u5341\u6708 \u5341\u4e00\u6708 \u5341\u4e8c\u6708".split(" "),
monthsShort:"\u4e00\u6708 \u4e8c\u6708 \u4e09\u6708 \u56db\u6708 \u4e94\u6708 \u516d\u6708 \u4e03\u6708 \u516b\u6708 \u4e5d\u6708 \u5341\u6708 \u5341\u4e00\u6708 \u5341\u4e8c\u6708".split(" "),today:"\u4eca\u5929",suffix:[],meridiem:["\u4e0a\u5348","\u4e0b\u5348"],rtl:!1};$("#starttime").datetimepicker({format:"yyyy-mm-dd",startView:2,minView:2,autoclose:!0,language:"zh-CN",weekStart:1,todayHighlight:!0}).on("show",function(){$("#starttime").val()||$("#starttime").datetimepicker("update",new Date)}).on("hide",
function(a){$("#endtime").datetimepicker("setStartDate",$("#starttime").val());a=DateDiff($("#starttime").val(),$("#endtime").val());$("#during").val(a)});$("#endtime").datetimepicker({format:"yyyy-mm-dd",startView:2,minView:2,autoclose:!0,language:"zh-CN",weekStart:1,todayHighlight:!0}).on("show",function(){$("#endtime").val()||$("#endtime").datetimepicker("update",new Date)}).on("hide",function(a){$("#starttime").datetimepicker("setEndDate",$("#endtime").val());a=DateDiff($("#starttime").val(),
$("#endtime").val());$("#during").val(a)});$("#during").on("change",function(){var a=DateAfter($("#starttime").val(),$("#during").val());$("#endtime").datetimepicker("update",new Date(a))});$("#modifyBut").on("click",function(){var a=$("#lic").val(),b=$("#starttime").val(),c=$("#endtime").val(),d=$("#during").val(),e=$("#cate_id").text(),f=$("#user_id").text();a&&b&&b&&d?(a=e+";"+f+";"+b+";"+d+";"+c+";"+a,b=new JSEncrypt,b.setKey($("#pk").text()),a=b.encrypt(a),$.ajax(contextPath+"/admin/userfun/activa",
{method:"post",data:{data:a},dataType:"json"}).then(function(a){a.data?self.location=document.referrer:AMUI.dialog.alert({title:"\u64cd\u4f5c\u5931\u8d25",content:a.msg,onConfirm:function(){}})})):AMUI.dialog.alert({title:"\u8b66\u544a",content:"\u60a8\u8fd8\u6709\u5185\u5bb9\u7559\u7a7a",onConfirm:function(){}})})});
var fo=function(){$("#starttime").attr("readonly","readonly");$("#endtime").attr("readonly","readonly")},bl=function(){$("#starttime").removeAttr("readonly");$("#endtime").removeAttr("readonly")},ch=function(){var a=$("#starttime").val(),b=$("#endtime").val();checkTime(a,b)?($("#alertboard1").text(""),$("#modifyBut").removeAttr("disabled")):($("#alertboard1").text("\u7ed3\u675f\u65e5\u671f\u65e9\u4e8e\u5f00\u59cb\u65e5\u671f"),$("#modifyBut").attr("disabled","true"));$("#during").val(DateDiff(a,b))},
exp_ch=function(){var a=$("#starttime").val(),b=parseInt($("#during").val());$("#endtime").val(DateAfter(a,b))};
